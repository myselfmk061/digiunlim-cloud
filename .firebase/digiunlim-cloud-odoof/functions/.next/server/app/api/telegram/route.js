(()=>{var e={};e.id=247,e.ids=[247],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6487:()=>{},6984:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>w,routeModule:()=>f,serverHooks:()=>h,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>x});var s={};r.r(s),r.d(s,{DELETE:()=>g,GET:()=>c,POST:()=>d});var o=r(6559),n=r(8088),a=r(7719),i=r(2190);function u(){let e=process.env.TELEGRAM_BOT_TOKEN;if(!e)throw Error("Storage service is not configured. Please contact support.");return e}function l(){let e=process.env.TELEGRAM_CHAT_ID;if(!e)throw Error("Storage service is not configured. Please contact support.");return e}async function p(e){let t=u(),r=await fetch(`https://api.telegram.org/bot${t}/getFile?file_id=${e}`),s=await r.json();if(!s.ok)throw Error(`Failed to get file info: ${s.description}`);return s.result}async function d(e){try{let t=u(),r=l(),s=`https://api.telegram.org/bot${t}`,o=(await e.formData()).get("file");if(!o)return i.NextResponse.json({error:"No file provided."},{status:400});let n=new FormData;n.append("chat_id",r),n.append("document",o);let a=await fetch(`${s}/sendDocument`,{method:"POST",body:n}),p=await a.json();if(!p.ok||!p.result.document)return i.NextResponse.json({error:"Failed to upload file to Telegram."},{status:500});let d=p.result.document,c={id:d.file_id,name:d.file_name||"Untitled",size:d.file_size,type:d.mime_type,uploadDate:new Date(1e3*p.result.date),url:"#",progress:"complete",telegramMessageId:p.result.message_id};return i.NextResponse.json(c,{status:201})}catch(t){let e=t instanceof Error?t.message:"An unknown error occurred";return i.NextResponse.json({error:"Internal server error.",details:e},{status:500})}}async function c(e){try{let t=u(),{searchParams:r}=new URL(e.url),s=r.get("fileId");if(!s)return i.NextResponse.json({error:"File ID is required"},{status:400});let o=await p(s),n=`https://api.telegram.org/file/bot${t}/${o.file_path}`;return i.NextResponse.redirect(n)}catch(t){let e=t instanceof Error?t.message:"An unknown error occurred";return i.NextResponse.json({error:"Could not get file download link",details:e},{status:500})}}async function g(e){try{let t=u(),r=l(),s=`https://api.telegram.org/bot${t}`,{searchParams:o}=new URL(e.url),n=o.get("messageId");if(!n)return i.NextResponse.json({error:"Message ID is required for deletion"},{status:400});let a=await fetch(`${s}/deleteMessage?chat_id=${r}&message_id=${n}`);return!(await a.json()).ok,i.NextResponse.json({message:"Delete request sent"},{status:200})}catch(t){let e=t instanceof Error?t.message:"An unknown error occurred";return i.NextResponse.json({error:"Internal server error",details:e},{status:500})}}let f=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/telegram/route",pathname:"/api/telegram",filename:"route",bundlePath:"app/api/telegram/route"},resolvedPagePath:"/home/user/studio/src/app/api/telegram/route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:m,workUnitAsyncStorage:x,serverHooks:h}=f;function w(){return(0,a.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:x})}},8335:()=>{},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,580],()=>r(6984));module.exports=s})();